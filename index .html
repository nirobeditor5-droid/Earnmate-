<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Developer Nirob - User Panel</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    <style>
        body { font-family: Arial; text-align: center; margin-top: 50px; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; cursor: pointer; }
        #balance { font-size: 20px; margin: 20px; }
    </style>
</head>
<body>

<h1>Developer Nirob</h1>
<div id="balance">Balance: $0.00</div>
<div id="monetag-ad"></div>

<button id="watch-ad">Watch Ad</button>
<button id="withdraw">Withdraw</button>

<script>
    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyAVjSwumtY6oqS7QFbcfTH4CY4UizaV2lk",
        authDomain: "earnmate-aadb9.firebaseapp.com",
        databaseURL: "https://earnmate-aadb9-default-rtdb.firebaseio.com",
        projectId: ''earnmate-aadb9",
        storageBucket: "earnmate-aadb9.firebasestorage.app",
        messagingSenderId: "631886987492",
        appId: "1:631886987492:web:9ce92605037552dbb0ecf1"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Generate or get user ID
    let userId = "user_" + Math.floor(Math.random()*10000);
    let balance = 0;

    // Display current balance
    function updateBalance() {
        document.getElementById("balance").innerText = "Balance: $" + balance.toFixed(2);
    }

    // Load balance from Firebase
    db.ref('users/' + userId + '/balance').once('value').then(snap => {
        balance = snap.val() || 0;
        updateBalance();
    });

    // Monetag script
    (function(m,o,n,e,t,a,g){
        m['MonetagObject']=t;
        m[t]=m[t]||function(){(m[t].q=m[t].q||[]).push(arguments)};
        a=o.createElement(n); a.async=1; a.src=e;
        g=o.getElementsByTagName(n)[0]; g.parentNode.insertBefore(a,g);
    })(window,document,'script','https://cdn.monetag.com/monetag.js','monetag');

    monetag('create', {
        zone: "3002143",  // ✅ তোমার zone ID
        container: "monetag-ad",
        width: 320,
        height: 50,
        responsive: true
    });

    // Watch ad button
    document.getElementById("watch-ad").addEventListener("click", () => {
        // Add earning per ad
        const earningPerAd = 0.10; // $0.10 per view
        balance += earningPerAd;
        updateBalance();

        // Save to Firebase
        db.ref('users/' + userId).update({balance: balance});

        alert("Ad watched! You earned $" + earningPerAd.toFixed(2));
    });

    // Withdraw button
    document.getElementById("withdraw").addEventListener("click", () => {
        const minWithdraw = 1; // Minimum withdraw
        if(balance >= minWithdraw) {
            db.ref('withdraw_requests/' + userId).set({
                amount: balance,
                timestamp: Date.now()
            });
            alert("Withdraw request sent!");
        } else {
            alert("You need at least $" + minWithdraw + " to withdraw.");
        }
    });
</script>

</body>
</html>